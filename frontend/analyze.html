<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyze | LogSense</title>
    <!-- Font: Times New Roman -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Times+New+Roman&display=swap');
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --dark-bg: #0f172a;
            --sidebar-bg: #1e293b;
            --card-bg: #1e293b;
            --card-border: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #3b82f6;
        }
        
        * {
            font-family: 'Times New Roman', Times, serif !important;
        }
        
        body {
            font-family: 'Times New Roman', Times, serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            display: flex;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        /* Sidebar */
        .sidebar {
            width: 250px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--card-border);
            padding: 30px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .logo {
            padding: 0 25px 30px;
            border-bottom: 1px solid var(--card-border);
            margin-bottom: 30px;
        }
        
        .logo h2 {
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--primary) 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
        }
        
        .logo p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 25px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(99, 102, 241, 0.1);
            color: var(--text-primary);
            border-left-color: var(--primary);
        }
        
        .nav-icon {
            width: 24px;
            margin-right: 12px;
            font-size: 1.1rem;
        }
        
        .nav-badge {
            margin-left: auto;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 0;
        }
        
        /* Topbar */
        .topbar {
            background: var(--card-bg);
            border-bottom: 1px solid var(--card-border);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-title h1 {
            font-size: 1.8rem;
            margin: 0;
            font-weight: bold;
        }
        
        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            padding: 8px 15px 8px 35px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--card-border);
            border-radius: 6px;
            color: var(--text-primary);
            width: 220px;
            font-size: 0.9rem;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .notification-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.1rem;
            cursor: pointer;
            position: relative;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 0.65rem;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Content Area */
        .content-wrapper {
            padding: 25px;
        }
        
        /* Investigation Tabs */
        .investigation-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--card-border);
            padding-bottom: 12px;
        }
        
        .investigation-tab {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.95rem;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .investigation-tab:hover {
            background: rgba(99, 102, 241, 0.1);
            color: var(--text-primary);
        }
        
        .investigation-tab.active {
            background: var(--primary);
            color: white;
        }
        
        /* Fraud Type Selection Grid */
        .selection-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .selection-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .selection-title i {
            font-size: 1.3rem;
            color: var(--primary);
        }
        
        .selection-title h2 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .fraud-types-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .fraud-checkbox {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .fraud-checkbox:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
        }
        
        .fraud-checkbox.selected {
            background: rgba(99, 102, 241, 0.15);
            border-color: var(--primary);
        }
        
        .fraud-checkbox input {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }
        
        .fraud-checkbox label {
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .fraud-checkbox i {
            width: 20px;
            text-align: center;
        }
        
        /* Dynamic Form Card */
        .form-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .form-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--card-border);
        }
        
        .form-header i {
            font-size: 1.2rem;
            color: var(--primary);
        }
        
        .form-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .form-header span {
            margin-left: auto;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .dynamic-form {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 5px;
        }
        
        .form-label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--card-border);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.95rem;
            box-sizing: border-box;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-control::placeholder {
            color: rgba(148, 163, 184, 0.5);
            font-size: 0.85rem;
        }
        
        .btn-primary {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 20px;
        }
        
        .btn-primary:hover {
            background: #4f52d9;
        }
        
        .btn-primary i {
            margin-right: 8px;
        }
        
        /* Results Card */
        .results-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .results-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .results-title i {
            font-size: 1.2rem;
            color: var(--danger);
        }
        
        .results-title h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .risk-badge-large {
            padding: 6px 16px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .risk-critical { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .risk-high { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .risk-medium { background: rgba(59, 130, 246, 0.2); color: var(--info); }
        .risk-low { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .result-item {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
        }
        
        .result-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .result-item-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .result-score {
            font-size: 1.6rem;
            font-weight: 700;
        }
        
        .result-meter {
            width: 100%;
            height: 6px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }
        
        .result-meter-fill {
            height: 100%;
            border-radius: 3px;
        }
        
        .result-signals {
            margin-top: 12px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .result-signal {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 6px;
        }
        
        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }
        
        .no-results i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--text-secondary);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 10px;
        }
        
        .action-btn {
            padding: 12px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }
        
        .action-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        .action-btn i {
            font-size: 1.2rem;
        }
        
        .action-btn span {
            font-size: 0.8rem;
        }
        
        .action-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .action-btn.disabled:hover {
            background: var(--card-bg);
            border-color: var(--card-border);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .fraud-types-grid { grid-template-columns: repeat(2, 1fr); }
            .dynamic-form { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 1024px) {
            .sidebar { width: 70px; }
            .main-content { margin-left: 70px; }
            .nav-text, .logo h2, .logo p { display: none; }
            .action-buttons { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 768px) {
            .fraud-types-grid { grid-template-columns: 1fr; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <h2>LogSense</h2>
            <p>Fraud Detection</p>
        </div>
        
        <nav class="sidebar-menu">
            <div class="nav-item">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-tachometer-alt nav-icon"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
            </div>
            
            <div class="nav-item">
                <a href="analyze.html" class="nav-link active">
                    <i class="fas fa-search nav-icon"></i>
                    <span class="nav-text">Analyze</span>
                </a>
            </div>
            
            <div class="nav-item">
                <a href="analytics.html" class="nav-link">
                    <i class="fas fa-chart-bar nav-icon"></i>
                    <span class="nav-text">Analytics</span>
                </a>
            </div>
            
            <div class="nav-item">
                <a href="alerts.html" class="nav-link">
                    <i class="fas fa-bell nav-icon"></i>
                    <span class="nav-text">Alerts</span>
                    <span class="nav-badge" id="alertBadge">3</span>
                </a>
            </div>
            
            <div class="nav-item">
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog nav-icon"></i>
                    <span class="nav-text">Settings</span>
                </a>
            </div>
            
            <div class="nav-item" style="margin-top: 50px;">
                <a href="login.html" class="nav-link">
                    <i class="fas fa-sign-out-alt nav-icon"></i>
                    <span class="nav-text">Logout</span>
                </a>
            </div>
        </nav>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <!-- Topbar -->
        <div class="topbar">
            <div class="page-title">
                <h1>Analyze</h1>
            </div>
            
            <div class="topbar-actions">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Search cases...">
                </div>
                
                <button class="notification-btn" onclick="window.location.href='alerts.html'">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge">3</span>
                </button>
            </div>
        </div>
        
        <!-- Content -->
        <div class="content-wrapper">
            <!-- Investigation Tabs (Kept) -->
            <div class="investigation-tabs">
                <button class="investigation-tab active" onclick="switchTab('transaction')">
                    <i class="fas fa-exchange-alt"></i> Transaction Analysis
                </button>
                <button class="investigation-tab" onclick="switchTab('user')">
                    <i class="fas fa-user"></i> User Radar
                </button>
                <button class="investigation-tab" onclick="switchTab('compare')">
                    <i class="fas fa-balance-scale"></i> Compare
                </button>
                <button class="investigation-tab" onclick="switchTab('batch')">
                    <i class="fas fa-layer-group"></i> Batch Scan
                </button>
            </div>
            
            <!-- Fraud Type Selection -->
            <div class="selection-card">
                <div class="selection-title">
                    <i class="fas fa-shield-alt"></i>
                    <h2>Select Fraud Types to Analyze</h2>
                </div>
                
                <div class="fraud-types-grid" id="fraudTypeGrid">
                    <!-- SIM Swap -->
                    <div class="fraud-checkbox selected" onclick="toggleFraudType(this, 'sim_swap')" data-type="sim_swap">
                        <input type="checkbox" id="chk_sim" checked onclick="event.stopPropagation()">
                        <label for="chk_sim">
                            <i class="fas fa-sim-card" style="color: #ef4444;"></i>
                            SIM Swap
                        </label>
                    </div>
                    
                    <!-- Identity Theft -->
                    <div class="fraud-checkbox selected" onclick="toggleFraudType(this, 'identity_theft')" data-type="identity_theft">
                        <input type="checkbox" id="chk_identity" checked onclick="event.stopPropagation()">
                        <label for="chk_identity">
                            <i class="fas fa-id-card" style="color: #ef4444;"></i>
                            Identity Theft
                        </label>
                    </div>
                    
                    <!-- Device Cloning -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'device_cloning')" data-type="device_cloning">
                        <input type="checkbox" id="chk_clone" onclick="event.stopPropagation()">
                        <label for="chk_clone">
                            <i class="fas fa-clone" style="color: #3b82f6;"></i>
                            Device Cloning
                        </label>
                    </div>
                    
                    <!-- Mobile Money Fraud -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'mobile_fraud')" data-type="mobile_fraud">
                        <input type="checkbox" id="chk_mobile" onclick="event.stopPropagation()">
                        <label for="chk_mobile">
                            <i class="fas fa-mobile-alt" style="color: #f59e0b;"></i>
                            Mobile Fraud
                        </label>
                    </div>
                    
                    <!-- Agent Collusion -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'agent_collusion')" data-type="agent_collusion">
                        <input type="checkbox" id="chk_agent" onclick="event.stopPropagation()">
                        <label for="chk_agent">
                            <i class="fas fa-user-secret" style="color: #94a3b8;"></i>
                            Agent Collusion
                        </label>
                    </div>
                    
                    <!-- Social Engineering -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'social_engineering')" data-type="social_engineering">
                        <input type="checkbox" id="chk_social" onclick="event.stopPropagation()">
                        <label for="chk_social">
                            <i class="fas fa-comment-dots" style="color: #94a3b8;"></i>
                            Social Engineering
                        </label>
                    </div>
                    
                    <!-- Synthetic Identity -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'synthetic_identity')" data-type="synthetic_identity">
                        <input type="checkbox" id="chk_synthetic" onclick="event.stopPropagation()">
                        <label for="chk_synthetic">
                            <i class="fas fa-user-plus" style="color: #94a3b8;"></i>
                            Synthetic Identity
                        </label>
                    </div>
                    
                    <!-- Repayment Fraud -->
                    <div class="fraud-checkbox" onclick="toggleFraudType(this, 'repayment_fraud')" data-type="repayment_fraud">
                        <input type="checkbox" id="chk_repayment" onclick="event.stopPropagation()">
                        <label for="chk_repayment">
                            <i class="fas fa-money-check-alt" style="color: #94a3b8;"></i>
                            Repayment Fraud
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Dynamic Input Form -->
            <div class="form-card" id="dynamicFormCard">
                <div class="form-header">
                    <i class="fas fa-pencil-alt"></i>
                    <h3 id="formTitle">SIM Swap Detection</h3>
                    <span id="formSubtitle">Enter SMS or call details</span>
                </div>
                
                <div id="inputFields">
                    <!-- SIM Swap Fields (Default) -->
                    <div id="sim_swap_fields" style="display: block;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Phone Number</label>
                                <input type="text" class="form-control" id="sim_phone" value="254712345678" placeholder="e.g., 254712345678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SMS / Alert Text</label>
                                <input type="text" class="form-control" id="sim_sms" value="Your SIM card has been activated on a new device" placeholder="Paste SMS text">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Current Carrier</label>
                                <input type="text" class="form-control" id="sim_carrier" value="Safaricom" placeholder="e.g., Safaricom">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Previous Carrier</label>
                                <input type="text" class="form-control" id="sim_prev_carrier" value="Airtel" placeholder="e.g., Airtel">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SIM Change Time</label>
                                <input type="text" class="form-control" id="sim_time" value="2 hours ago" placeholder="e.g., 2 hours ago">
                            </div>
                            <div class="form-group">
                                <label class="form-label">New Device?</label>
                                <select class="form-control" id="sim_new_device">
                                    <option>Yes</option>
                                    <option>No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Identity Theft Fields -->
                    <div id="identity_theft_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Transaction Amount</label>
                                <input type="number" class="form-control" id="id_amount" value="45000" placeholder="KES">
                            </div>
                            <div class="form-group">
                                <label class="form-label">User's Normal Amount</label>
                                <input type="number" class="form-control" id="id_normal_amount" value="2500" placeholder="KES">
                            </div>
                            <div class="form-group">
                                <label class="form-label">New Device?</label>
                                <select class="form-control" id="id_new_device">
                                    <option>Yes</option>
                                    <option>No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Location Changed?</label>
                                <select class="form-control" id="id_location_change">
                                    <option>Yes</option>
                                    <option>No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Document Verified?</label>
                                <select class="form-control" id="id_document">
                                    <option>No</option>
                                    <option>Yes</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Device Cloning Fields -->
                    <div id="device_cloning_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Device ID</label>
                                <input type="text" class="form-control" id="clone_device_id" value="DEV-CLONE-123" placeholder="Device ID">
                            </div>
                            <div class="form-group">
                                <label class="form-label">IP Address</label>
                                <input type="text" class="form-control" id="clone_ip" value="197.248.0.1" placeholder="IP Address">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Current Location</label>
                                <input type="text" class="form-control" id="clone_location" value="Nairobi, Kenya" placeholder="City, Country">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Device Rooted?</label>
                                <select class="form-control" id="clone_rooted">
                                    <option>Yes</option>
                                    <option>No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">App Tampered?</label>
                                <select class="form-control" id="clone_tampered">
                                    <option>Yes</option>
                                    <option>No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile Fraud Fields -->
                    <div id="mobile_fraud_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Amount</label>
                                <input type="number" class="form-control" id="mobile_amount" value="125000" placeholder="KES">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Transactions in 5min</label>
                                <input type="number" class="form-control" id="mobile_velocity" value="8" placeholder="Count">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unique Recipients</label>
                                <input type="number" class="form-control" id="mobile_recipients" value="7" placeholder="Count">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Normal Transaction Speed</label>
                                <input type="text" class="form-control" id="mobile_normal" value="1-2 per day" placeholder="e.g., 1-2 per day">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Agent Collusion Fields -->
                    <div id="agent_collusion_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Agent ID</label>
                                <input type="text" class="form-control" id="agent_id" placeholder="Agent Number">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Customer ID</label>
                                <input type="text" class="form-control" id="agent_customer" placeholder="Customer ID">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Transaction Amount</label>
                                <input type="number" class="form-control" id="agent_amount" placeholder="KES">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Commission</label>
                                <input type="text" class="form-control" id="agent_commission" placeholder="Amount">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Social Engineering Fields -->
                    <div id="social_engineering_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Caller ID</label>
                                <input type="text" class="form-control" id="social_caller" value="+254700123456" placeholder="Phone number">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Caller Claim</label>
                                <input type="text" class="form-control" id="social_claim" value="Safaricom Support" placeholder="e.g., Bank, Telco">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Request</label>
                                <input type="text" class="form-control" id="social_request" value="Send M-PESA to 0712345678 for verification" placeholder="What they asked for">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Call Duration</label>
                                <input type="text" class="form-control" id="social_duration" value="12:34 minutes" placeholder="Duration">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Synthetic Identity Fields -->
                    <div id="synthetic_identity_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Account Age</label>
                                <input type="text" class="form-control" id="synthetic_age" placeholder="e.g., 2 months">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Document Type</label>
                                <input type="text" class="form-control" id="synthetic_doc" placeholder="ID, Passport">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Verification Status</label>
                                <select class="form-control" id="synthetic_verified">
                                    <option>Pending</option>
                                    <option>Verified</option>
                                    <option>Failed</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Repayment Fraud Fields -->
                    <div id="repayment_fraud_fields" style="display: none;">
                        <div class="dynamic-form">
                            <div class="form-group">
                                <label class="form-label">Loan ID</label>
                                <input type="text" class="form-control" id="repayment_loan" placeholder="Loan number">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Repayment Amount</label>
                                <input type="number" class="form-control" id="repayment_amount" placeholder="KES">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Expected Amount</label>
                                <input type="number" class="form-control" id="repayment_expected" placeholder="KES">
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="analyzeFraud()">
                    <i class="fas fa-shield-alt"></i> Detect Fraud
                </button>
            </div>
            
            <!-- Results Card -->
            <div class="results-card" id="resultsCard">
                <div id="noResults">
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <h3>No Analysis Yet</h3>
                        <p>Select fraud types, enter details, and click "Detect Fraud"</p>
                    </div>
                </div>
                
                <div id="resultsContent" style="display: none;">
                    <div class="results-header">
                        <div class="results-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Detection Results</h3>
                        </div>
                        <span id="overallRiskBadge" class="risk-badge-large risk-critical">CRITICAL RISK</span>
                    </div>
                    
                    <div id="resultsGrid" class="results-grid">
                        <!-- Results populated by JavaScript -->
                    </div>
                    
                    <div style="margin-top: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <span style="color: var(--text-secondary);">
                                <i class="fas fa-envelope"></i> Alert recipient: rebeccabosibori589@gmail.com
                            </span>
                            <span style="color: var(--success); font-size: 0.85rem;">
                                <i class="fas fa-check-circle"></i> Autoencoder thresholds active
                            </span>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="action-btn" onclick="createAlert()">
                                <i class="fas fa-bell"></i>
                                <span>Create Alert</span>
                            </button>
                            <button class="action-btn" onclick="blockTransaction()">
                                <i class="fas fa-ban"></i>
                                <span>Block</span>
                            </button>
                            <button class="action-btn" onclick="reviewCase()">
                                <i class="fas fa-clock"></i>
                                <span>Review</span>
                            </button>
                            <button class="action-btn" onclick="clearAnalysis()">
                                <i class="fas fa-redo"></i>
                                <span>New</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_URL = 'https://fraud-detection-api-b6dk.onrender.com';
        const USER_EMAIL = 'rebeccabosibori589@gmail.com';
        
        // Selected fraud types
        let selectedFraudTypes = ['sim_swap', 'identity_theft'];
        
        // Toggle fraud type selection
        function toggleFraudType(element, type) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('selected');
            
            if (checkbox.checked) {
                if (!selectedFraudTypes.includes(type)) {
                    selectedFraudTypes.push(type);
                }
            } else {
                selectedFraudTypes = selectedFraudTypes.filter(t => t !== type);
            }
            
            // Update form fields based on first selected fraud type
            if (selectedFraudTypes.length > 0) {
                showFields(selectedFraudTypes[0]);
            }
        }
        
        // Show fields for selected fraud type
        function showFields(type) {
            // Hide all fields
            const fieldSets = ['sim_swap', 'identity_theft', 'device_cloning', 'mobile_fraud', 
                             'agent_collusion', 'social_engineering', 'synthetic_identity', 'repayment_fraud'];
            
            fieldSets.forEach(f => {
                const el = document.getElementById(`${f}_fields`);
                if (el) el.style.display = 'none';
            });
            
            // Show selected fields
            const selectedEl = document.getElementById(`${type}_fields`);
            if (selectedEl) {
                selectedEl.style.display = 'block';
                
                // Update form title
                const titles = {
                    'sim_swap': 'SIM Swap Detection',
                    'identity_theft': 'Identity Theft Detection',
                    'device_cloning': 'Device Cloning Detection',
                    'mobile_fraud': 'Mobile Money Fraud Detection',
                    'agent_collusion': 'Agent Collusion Detection',
                    'social_engineering': 'Social Engineering Detection',
                    'synthetic_identity': 'Synthetic Identity Detection',
                    'repayment_fraud': 'Repayment Fraud Detection'
                };
                
                const subtitles = {
                    'sim_swap': 'Enter SMS or call details',
                    'identity_theft': 'Enter transaction and user behavior',
                    'device_cloning': 'Enter device and location details',
                    'mobile_fraud': 'Enter transaction velocity details',
                    'agent_collusion': 'Enter agent and transaction details',
                    'social_engineering': 'Enter call or message details',
                    'synthetic_identity': 'Enter account and document details',
                    'repayment_fraud': 'Enter loan repayment details'
                };
                
                document.getElementById('formTitle').textContent = titles[type] || 'Fraud Detection';
                document.getElementById('formSubtitle').textContent = subtitles[type] || 'Enter relevant details';
            }
        }
        
        // Analyze fraud based on selected types
        function analyzeFraud() {
            const resultsGrid = document.getElementById('resultsGrid');
            const resultsContent = document.getElementById('resultsContent');
            const noResults = document.getElementById('noResults');
            
            resultsGrid.innerHTML = '';
            
            if (selectedFraudTypes.length === 0) {
                alert('Please select at least one fraud type to analyze');
                return;
            }
            
            // Show results section
            noResults.style.display = 'none';
            resultsContent.style.display = 'block';
            
            // Analyze each selected fraud type
            selectedFraudTypes.forEach(type => {
                let result = null;
                
                switch(type) {
                    case 'sim_swap':
                        result = analyzeSimSwap();
                        break;
                    case 'identity_theft':
                        result = analyzeIdentityTheft();
                        break;
                    case 'device_cloning':
                        result = analyzeDeviceCloning();
                        break;
                    case 'mobile_fraud':
                        result = analyzeMobileFraud();
                        break;
                    case 'social_engineering':
                        result = analyzeSocialEngineering();
                        break;
                    case 'agent_collusion':
                    case 'synthetic_identity':
                    case 'repayment_fraud':
                        result = {
                            fraud_type: type,
                            risk_score: 12,
                            risk_level: 'LOW',
                            signals: ['Demo detection - API integration ready'],
                            color: '#10b981'
                        };
                        break;
                }
                
                if (result) {
                    addResultCard(result);
                }
            });
            
            // Set overall risk badge
            const riskScores = selectedFraudTypes.map(t => {
                if (t === 'sim_swap') return 98;
                if (t === 'identity_theft') return 92;
                if (t === 'device_cloning') return 82;
                if (t === 'mobile_fraud') return 87;
                if (t === 'social_engineering') return 94;
                return 12;
            });
            
            const maxRisk = Math.max(...riskScores);
            const badge = document.getElementById('overallRiskBadge');
            
            if (maxRisk >= 80) {
                badge.className = 'risk-badge-large risk-critical';
                badge.textContent = 'CRITICAL RISK';
            } else if (maxRisk >= 60) {
                badge.className = 'risk-badge-large risk-high';
                badge.textContent = 'HIGH RISK';
            } else if (maxRisk >= 40) {
                badge.className = 'risk-badge-large risk-medium';
                badge.textContent = 'MEDIUM RISK';
            } else {
                badge.className = 'risk-badge-large risk-low';
                badge.textContent = 'LOW RISK';
            }
        }
        
        // Analyze SIM Swap
        function analyzeSimSwap() {
            const phone = document.getElementById('sim_phone').value;
            const sms = document.getElementById('sim_sms').value;
            const carrier = document.getElementById('sim_carrier').value;
            const prevCarrier = document.getElementById('sim_prev_carrier').value;
            const time = document.getElementById('sim_time').value;
            const newDevice = document.getElementById('sim_new_device').value;
            
            let riskScore = 98;
            let signals = [];
            
            if (sms.toLowerCase().includes('sim') || sms.toLowerCase().includes('activated')) {
                signals.push('SIM swap alert detected in SMS');
            }
            
            if (newDevice === 'Yes') {
                signals.push('New device detected');
            }
            
            if (carrier !== prevCarrier) {
                signals.push(`Carrier changed: ${prevCarrier} → ${carrier}`);
            }
            
            signals.push(`SIM changed: ${time}`);
            
            return {
                fraud_type: 'sim_swap',
                display_name: 'SIM Swap Fraud',
                icon: 'fa-sim-card',
                color: '#ef4444',
                risk_score: riskScore,
                risk_level: 'CRITICAL',
                signals: signals
            };
        }
        
        // Analyze Identity Theft
        function analyzeIdentityTheft() {
            const amount = parseFloat(document.getElementById('id_amount').value);
            const normalAmount = parseFloat(document.getElementById('id_normal_amount').value);
            const newDevice = document.getElementById('id_new_device').value;
            const locationChange = document.getElementById('id_location_change').value;
            const documentVerified = document.getElementById('id_document').value;
            
            const ratio = amount / normalAmount;
            let riskScore = Math.min(92, Math.round(ratio * 5));
            let signals = [];
            
            signals.push(`Amount: ${ratio.toFixed(0)}x above normal (KES ${normalAmount.toLocaleString()} → KES ${amount.toLocaleString()})`);
            
            if (newDevice === 'Yes') {
                signals.push('New device - not in trusted list');
            }
            
            if (locationChange === 'Yes') {
                signals.push('Location changed from usual area');
            }
            
            if (documentVerified === 'No') {
                signals.push('Document verification failed');
            }
            
            return {
                fraud_type: 'identity_theft',
                display_name: 'Identity Theft',
                icon: 'fa-id-card',
                color: '#ef4444',
                risk_score: riskScore,
                risk_level: riskScore > 80 ? 'CRITICAL' : 'HIGH',
                signals: signals
            };
        }
        
        // Analyze Device Cloning
        function analyzeDeviceCloning() {
            const deviceId = document.getElementById('clone_device_id').value;
            const ip = document.getElementById('clone_ip').value;
            const location = document.getElementById('clone_location').value;
            const rooted = document.getElementById('clone_rooted').value;
            const tampered = document.getElementById('clone_tampered').value;
            
            let riskScore = 82;
            let signals = [];
            
            signals.push(`Device ID: ${deviceId}`);
            signals.push(`Current location: ${location}`);
            
            if (rooted === 'Yes') {
                signals.push('Device is rooted - security risk');
                riskScore += 10;
            }
            
            if (tampered === 'Yes') {
                signals.push('Application integrity check failed');
                riskScore += 10;
            }
            
            // Simulate multiple locations
            if (deviceId.includes('CLONE')) {
                signals.push('⚠️ Device active in 2 locations simultaneously');
                signals.push('Location 1: Nairobi, Kenya (2 min ago)');
                signals.push('Location 2: Lagos, Nigeria (1 min ago)');
                riskScore = 95;
            }
            
            return {
                fraud_type: 'device_cloning',
                display_name: 'Device Cloning',
                icon: 'fa-clone',
                color: riskScore > 80 ? '#ef4444' : '#f59e0b',
                risk_score: Math.min(riskScore, 98),
                risk_level: riskScore > 80 ? 'CRITICAL' : 'HIGH',
                signals: signals
            };
        }
        
        // Analyze Mobile Fraud
        function analyzeMobileFraud() {
            const amount = parseFloat(document.getElementById('mobile_amount').value);
            const velocity = parseInt(document.getElementById('mobile_velocity').value);
            const recipients = parseInt(document.getElementById('mobile_recipients').value);
            const normal = document.getElementById('mobile_normal').value;
            
            let riskScore = 87;
            let signals = [];
            
            signals.push(`Amount: KES ${amount.toLocaleString()}`);
            signals.push(`Transaction velocity: ${velocity} transactions in 5 minutes`);
            signals.push(`Unique recipients: ${recipients} different people`);
            signals.push(`Normal pattern: ${normal}`);
            
            if (velocity >= 8) {
                signals.push('⚠️ Velocity threshold exceeded');
                riskScore += 5;
            }
            
            if (recipients >= 7) {
                signals.push('⚠️ Multiple recipients in short time');
            }
            
            return {
                fraud_type: 'mobile_fraud',
                display_name: 'Mobile Money Fraud',
                icon: 'fa-mobile-alt',
                color: '#f59e0b',
                risk_score: Math.min(riskScore, 95),
                risk_level: 'HIGH',
                signals: signals
            };
        }
        
        // Analyze Social Engineering
        function analyzeSocialEngineering() {
            const caller = document.getElementById('social_caller').value;
            const claim = document.getElementById('social_claim').value;
            const request = document.getElementById('social_request').value;
            const duration = document.getElementById('social_duration').value;
            
            let riskScore = 94;
            let signals = [];
            
            signals.push(`Caller: ${caller} claiming to be ${claim}`);
            signals.push(`Request: "${request}"`);
            signals.push(`Duration: ${duration}`);
            
            if (request.toLowerCase().includes('send') || request.toLowerCase().includes('mpesa') || request.toLowerCase().includes('transfer')) {
                signals.push('⚠️ Request for money transfer - common scam pattern');
            }
            
            if (claim.includes('Safaricom') || claim.includes('Bank')) {
                signals.push('⚠️ Impersonation of trusted organization');
            }
            
            return {
                fraud_type: 'social_engineering',
                display_name: 'Social Engineering',
                icon: 'fa-comment-dots',
                color: '#ef4444',
                risk_score: riskScore,
                risk_level: 'CRITICAL',
                signals: signals
            };
        }
        
        // Add result card to grid
        function addResultCard(result) {
            const grid = document.getElementById('resultsGrid');
            
            const card = document.createElement('div');
            card.className = 'result-item';
            
            card.innerHTML = `
                <div class="result-item-header">
                    <div class="result-item-title">
                        <i class="fas ${result.icon}" style="color: ${result.color};"></i>
                        ${result.display_name}
                    </div>
                    <span style="color: ${result.color}; font-weight: 600;">${result.risk_level}</span>
                </div>
                <div class="result-score" style="color: ${result.color};">${result.risk_score}%</div>
                <div class="result-meter">
                    <div class="result-meter-fill" style="width: ${result.risk_score}%; background: ${result.color};"></div>
                </div>
                <div class="result-signals">
                    ${result.signals.map(s => `<div class="result-signal"><i class="fas fa-circle" style="font-size: 0.4rem; color: ${result.color};"></i> ${s}</div>`).join('')}
                </div>
            `;
            
            grid.appendChild(card);
        }
        
        // Create alert
        function createAlert() {
            alert(`✅ Fraud alert created! Notification sent to ${USER_EMAIL}`);
        }
        
        // Block transaction
        function blockTransaction() {
            alert(' Transaction blocked. User notified.');
        }
        
        // Review case
        function reviewCase() {
            alert(' Case flagged for manual review.');
        }
        
        // Clear analysis
        function clearAnalysis() {
            document.getElementById('resultsContent').style.display = 'none';
            document.getElementById('noResults').style.display = 'block';
        }
        
        // Switch tabs
        function switchTab(tab) {
            document.querySelectorAll('.investigation-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'user') {
                alert(' User Radar - View all transactions for a specific user');
            } else if (tab === 'compare') {
                alert(' Compare - Side-by-side comparison of two transactions');
            } else if (tab === 'batch') {
                alert(' Batch Scan - Analyze multiple transactions at once');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default selected
            showFields('sim_swap');
            
            // Load notification badge
            fetch(`${API_URL}/api/v2/alerts/recent?limit=10`)
                .then(res => res.json())
                .then(alerts => {
                    const critical = alerts.filter(a => a.risk_level === 'CRITICAL').length;
                    const high = alerts.filter(a => a.risk_level === 'HIGH').length;
                    const total = critical + high;
                    document.getElementById('alertBadge').textContent = total;
                    document.getElementById('notificationBadge').textContent = total;
                })
                .catch(() => console.log('Using demo badge'));
        });
    </script>
</body>
</html>
